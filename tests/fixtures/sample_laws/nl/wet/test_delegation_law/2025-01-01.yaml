---
$schema: https://example.com/schema/v0.1.0/schema.json
$id: test_delegation_law
uuid: dddddddd-dddd-dddd-dddd-dddddddddddd
regulatory_layer: WET
publication_date: '2025-01-01'

identifiers:
  bwb_id: BWBRTEST004
  url: https://example.com/test_delegation_law

articles:
  # Article that defines delegation interface
  - number: '1'
    text: Delegation grondslag - gemeenten moeten dit implementeren
    url: https://example.com/test_delegation_law#1
    machine_readable:
      legal_basis_for:
        - regulatory_layer: GEMEENTELIJKE_VERORDENING
          subject: test_delegation
          contract:
            parameters:
              - name: input_value
                type: number
                required: true
            output:
              - name: delegated_result
                type: number

  # Article that uses delegation
  - number: '2'
    text: Orkestrator artikel dat delegation gebruikt
    url: https://example.com/test_delegation_law#2
    machine_readable:
      public: true
      endpoint: final_result
      execution:
        parameters:
          - name: gemeente_code
            type: string
            required: true
          - name: input_value
            type: number
            required: true
        input:
          # When output: X is specified, delegation returns just the value (not a dict)
          - name: delegated_result_value
            type: number
            source:
              delegation:
                law_id: test_delegation_law
                article: '1'
                select_on:
                  - name: gemeente_code
                    value: $gemeente_code
              output: delegated_result
              parameters:
                input_value: $input_value
        output:
          - name: final_result
            type: number
        actions:
          - output: final_result
            operation: ADD
            values:
              - 1000
              - $delegated_result_value
